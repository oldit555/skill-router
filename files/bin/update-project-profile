#!/bin/bash
# update-project-profile - Clears project cache to force fresh analysis
# Usage: update-project-profile [project_dir]
#
# This script deletes the project cache, forcing Sonnet to do a full
# cold start analysis on the next session. Sonnet will:
# - Read the skill catalog
# - Scan project files (package.json, configs, source)
# - Detect project type, stack, frameworks
# - Save everything to a new cache

set -euo pipefail

PROJECT_DIR="${1:-.}"
PROJECT_DIR=$(cd "$PROJECT_DIR" && pwd)
PROJECT_NAME=$(basename "$PROJECT_DIR")
CACHE_DIR="$HOME/.claude/projects"
CACHE_FILE="$CACHE_DIR/${PROJECT_NAME}.cache.yaml"

echo "Project: $PROJECT_NAME"
echo "Path: $PROJECT_DIR"
echo ""

if [[ -f "$CACHE_FILE" ]]; then
  rm -f "$CACHE_FILE"
  echo "Cache cleared: $CACHE_FILE"
  echo "Next session will do full analysis (cold start)."
else
  echo "No cache found. Next session will do full analysis."
fi

echo ""
